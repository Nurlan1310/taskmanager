{% extends "base.html" %}
{% block title %}–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏{% endblock %}

{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold">üë• –°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</h3>
    <a href="/admin/tasks/employee/" class="btn btn-sm btn-outline-secondary">
      ‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –∞–¥–º–∏–Ω–∫–µ
    </a>
  </div>

  <!-- üîç –ü–æ–∏—Å–∫ -->
  <div class="input-group mb-3 shadow-sm">
    <span class="input-group-text bg-light">üîç</span>
    <input id="searchInput" type="text" class="form-control" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏, –æ—Ç–¥–µ–ª—É –∏–ª–∏ —Ä–æ–ª–∏...">
  </div>

  <!-- üìã –¢–∞–±–ª–∏—Ü–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ -->
  <div class="table-responsive shadow-sm rounded-3">
    <table class="table table-hover align-middle mb-0">
      <thead class="table-light">
        <tr>
          <th>üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
          <th>üìã –î–æ–ª–∂–Ω–æ—Å—Ç—å</th>
          <th>üè¢ –û—Ç–¥–µ–ª</th>
          <th>üéØ –†–æ–ª—å</th>
        </tr>
      </thead>
      <tbody id="employeeTable">
        {% for employee in employees %}
        <tr>
          <td>
            <a href="{% url 'employee_detail' employee.id %}" class="text-decoration-none fw-semibold">
                {{ employee.user.get_full_name|default:employee.user.username }}
            </a><br>

            <small class="text-muted">{{ employee.user.email|default:"‚Äî" }}</small>
          </td>
          <td>{{ employee.position|default:"‚Äî" }}</td>
          <td>{{ employee.department.name|default:"‚Äî" }}</td>
          <td>
            <span class="badge
              {% if employee.role == 'director' %}bg-primary
              {% elif employee.role == 'deputy' %}bg-info
              {% elif employee.role == 'head' %}bg-success
              {% elif employee.role == 'senior' %}bg-warning text-dark
              {% else %}bg-secondary{% endif %}">
              {{ employee.get_role_display }}
            </span>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4" class="text-center text-muted">–ù–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- üîé JS-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è -->
<script>
  const searchInput = document.getElementById('searchInput');
  const rows = document.querySelectorAll('#employeeTable tr');

  searchInput.addEventListener('keyup', function() {
    const filter = this.value.toLowerCase();
    rows.forEach(row => {
      const text = row.textContent.toLowerCase();
      row.style.display = text.includes(filter) ? '' : 'none';
    });
  });
</script>
{% endblock %}

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand fw-bold" href="/">TaskManager</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav ms-auto align-items-center">

        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
        <li class="nav-item dropdown position-relative mx-3">

            <a class="nav-link p-0 dropdown-toggle" href="{% url 'notifications' %}"
               id="notifDropdown" role="button"
               data-bs-toggle="dropdown" aria-expanded="false">üîî–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

                <i class="bi bi-bell" style="font-size: 22px;"></i>

                {% if unread_notifications > 0 %}
                <!-- –ö—Ä—É–≥–ª—ã–π –±–µ–π–¥–∂ –∫–∞–∫ –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ -->
                <span class="badge-circle bg-danger text-white position-absolute"
                      style="top: -2px; left: -10px;
                             font-size: 0.55rem;
                             padding: 3px 8px;
                             border-radius: 100%;">
                    {{ unread_notifications }}
                </span>
                {% endif %}
            </a>

            <!-- –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ -->
            <ul class="dropdown-menu dropdown-menu-end shadow-sm p-2"
                aria-labelledby="notifDropdown"
                style="width: 320px;">

                {% if last_notifications %}
                    {% for n in last_notifications %}
                    <li class="mb-1">
                        <a href="{% url 'notification_read' n.id %}" class="dropdown-item small text-wrap">
                            {{ n.message }}
                            <div class="text-muted" style="font-size: 11px;">
                                {{ n.created_at|date:"d.m H:i" }}
                            </div>
                        </a>
                    </li>
                    {% endfor %}

                    {% if unread_notifications > last_notifications|length %}
                    <li>
                        <div class="dropdown-item text-center small text-muted">
                            + –µ—â—ë {{ unread_notifications|add:"-3" }} —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
                        </div>
                    </li>
                    {% endif %}

                    <li><hr class="dropdown-divider"></li>

                    <li>
                        <a class="dropdown-item text-center fw-bold small" href="{% url 'notifications' %}">
                            –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ ‚Üí
                        </a>
                    </li>

                {% else %}
                    <li class="dropdown-item small text-muted text-center">
                        –ù–µ—Ç –Ω–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
                    </li>

                    <li>
                        <a class="dropdown-item text-center fw-bold small" href="{% url 'notifications' %}">
                            –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ ‚Üí
                        </a>
                    </li>
                {% endif %}
            </ul>

        </li>


        <!-- –ó–∞–¥–∞—á–∏ -->
        <li class="nav-item">
          <a class="nav-link {% if request.resolver_match.url_name == 'task_list' %}active{% endif %}" href="{% url 'task_list' %}">üìã –ó–∞–¥–∞—á–∏</a>
        </li>


        <!-- –ú–µ–Ω—é —Å –≤—ã–ø–∞–¥–∞—é—â–∏–º —Å–ø–∏—Å–∫–æ–º -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarMenuDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            ‚ò∞ –ú–µ–Ω—é
          </a>
          <ul class="dropdown-menu dropdown-menu-end bg-dark border-0 shadow-sm" aria-labelledby="navbarMenuDropdown">

            <li>
              <a class="dropdown-item text-light" href="{% url 'employee_list' %}">
                üë• –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
              </a>
            </li>

            <li>
              <a class="dropdown-item text-light" href="{% url 'my_delegation' %}">
                üîÅ –ó–∞–º–µ—â–µ–Ω–∏–µ
              </a>
            </li>

            {% if user.is_staff %}
            <li><hr class="dropdown-divider bg-secondary"></li>
            <li>
              <a class="dropdown-item text-light" href="/admin/">
                ‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞
              </a>
            </li>
            {% endif %}

            <li><hr class="dropdown-divider bg-secondary"></li>
            <li>
              <a class="dropdown-item text-light" href="{% url 'logout' %}">
                üö™ –í—ã–π—Ç–∏
              </a>
            </li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>
